import{_ as i,c as a,o as n,b2 as l}from"./chunks/framework.CF7B9edl.js";const g=JSON.parse('{"title":"获取文件 MD5 值","description":"","frontmatter":{},"headers":[],"relativePath":"zh/functions/文件MD5.md","filePath":"zh/functions/文件MD5.md","lastUpdated":1742831199000}'),h={name:"zh/functions/文件MD5.md"};function p(k,s,t,e,r,D){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="获取文件-md5-值" tabindex="-1">获取文件 MD5 值 <a class="header-anchor" href="#获取文件-md5-值" aria-label="Permalink to &quot;获取文件 MD5 值&quot;">​</a></h1><blockquote><p>SparkMD5 是 MD5 算法的一个快速 md5 实现。 文档 • <a href="https://github.com/satazor/js-spark-md5" target="_blank" rel="noreferrer">https://github.com/satazor/js-spark-md5</a> • <a href="https://www.npmjs.com/package/spark-md5" target="_blank" rel="noreferrer">https://www.npmjs.com/package/spark-md5</a></p></blockquote><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes OneLight dark-plus vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">CDN引入</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">&lt;script </span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">src</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">&quot;https://cdn.bootcdn.net/ajax/libs/spark-md5/3.0.2/spark-md5.min.js&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">/script</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">npm安装</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">npm</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#569CD6;"> --save</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;"> spark-md5npm</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;"> i</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;"> spark-md5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>使用方式一：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes OneLight dark-plus vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">var</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> hexHash</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> SparkMD5</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">hash</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">&#39;Hi there&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">console</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">hexHash</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">// d9385462d3deff78c352ebb3f941ce12</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>使用方式二：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes OneLight dark-plus vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">var</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> spark</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;"> SparkMD5</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">spark</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">&#39;Hi&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">spark</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">&#39; &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">spark</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">&#39;there&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">var</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> hexHash</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> spark</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">console</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">hexHash</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">// d9385462d3deff78c352ebb3f941ce12</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>vue文件</code></p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes OneLight dark-plus vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C586C0;">import</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;"> SparkMD5</span><span style="--shiki-light:#A626A4;--shiki-dark:#C586C0;"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;"> &#39;spark-md5&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes OneLight dark-plus vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">// 获取上传文件的MD5(适用大文件)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">getFileMd5</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">chunkCount</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C586C0;">	return</span><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#4EC9B0;"> Promise</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">((</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">resolve</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">reject</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">=&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">    	const</span><span style="--shiki-light:#986801;--shiki-dark:#4FC1FF;"> blobSlice</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#4EC9B0;">            File</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">prototype</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">slice</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> ||</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#4EC9B0;">            File</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">prototype</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">mozSlice</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> ||</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#4EC9B0;">            File</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">prototype</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">webkitSlice</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">            const</span><span style="--shiki-light:#986801;--shiki-dark:#4FC1FF;"> chunks</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> chunkCount</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">            let</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> currentChunk</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#B5CEA8;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">            const</span><span style="--shiki-light:#986801;--shiki-dark:#4FC1FF;"> spark</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;"> new</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> SparkMD5</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">ArrayBuffer</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">            const</span><span style="--shiki-light:#986801;--shiki-dark:#4FC1FF;"> fileReader</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;"> FileReader</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">        fileReader</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">onload</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">=&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">            console</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">                &quot;文件字节大小&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">                fileReader</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">result</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">                fileReader</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">result</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">byteLength</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">            );</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">            spark</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">target</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">result</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">            currentChunk</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;">++</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C586C0;">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">currentChunk</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> chunks</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">                console</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">                    \`第</span><span style="--shiki-light:#CA1243;--shiki-dark:#569CD6;">\${</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">currentChunk</span><span style="--shiki-light:#CA1243;--shiki-dark:#569CD6;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">分片解析完成, 开始第</span><span style="--shiki-light:#CA1243;--shiki-dark:#569CD6;">\${</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">                    currentChunk</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> +</span><span style="--shiki-light:#986801;--shiki-dark:#B5CEA8;"> 1</span></span>
<span class="line"><span style="--shiki-light:#CA1243;--shiki-dark:#569CD6;">                    }</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;"> / </span><span style="--shiki-light:#CA1243;--shiki-dark:#569CD6;">\${</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">chunks</span><span style="--shiki-light:#CA1243;--shiki-dark:#569CD6;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">分片解析\`</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">                );</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">                loadNext</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">            } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C586C0;">else</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">                const</span><span style="--shiki-light:#986801;--shiki-dark:#4FC1FF;"> md5</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> spark</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">                spark</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">destroy</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">//释放缓存</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">                // 获取完输出md5值</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">                resolve</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">( </span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">md5</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> });</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">        fileReader</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">onerror</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;"> function</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">            file</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">cancel</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">            reject</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">        fileReader</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">onprogress</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;"> function</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">            // 在读取Blob时触发，读取上传进度，50ms左右调用一次</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">            console</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">&quot;读取中 onprogress:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">            console</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">                &quot;已读取:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">                e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">loaded</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">                e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">total</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">                Math</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">ceil</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">((</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">loaded</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> /</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">total</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) </span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;">*</span><span style="--shiki-light:#986801;--shiki-dark:#B5CEA8;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) </span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;"> &quot;%&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">            );</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">        let</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> _this</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#569CD6;"> this</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">        function</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;"> loadNext</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">            let</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> start</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> currentChunk</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> _this</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">chunkSize</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#569CD6;">            let</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> end</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;"> start</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> _this</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">chunkSize</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C586C0;">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">end</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> &gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">size</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">                end</span><span style="--shiki-light:#0184BC;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#9CDCFE;">size</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">            fileReader</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">readAsArrayBuffer</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">                blobSlice</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">call</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">start</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">            );</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#9CDCFE;">        console</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#CE9178;">&quot;执行顺序6，fileReader&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#9CDCFE;">fileReader</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#DCDCAA;">        loadNext</span><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">	});</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D4D4D4;">},</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div>`,10)]))}const A=i(h,[["render",p]]);export{g as __pageData,A as default};
